# Technology Stack & Build System

## Core Technologies

- **Python 3.13+**: Modern Python with full type hints and async support
- **Pydantic v2**: Type validation and serialization throughout the stack
- **UV**: Fast Python package manager and project management
- **Async/Await**: Fully async architecture using asyncio

## Key Dependencies

### Core Framework
- `pydantic-ai`: PydanticAI provider support
- `llmling-models`: Additional models and pydantic-ai tools
- `slashed`: SLash command framework
- `sqlmodel`: Type-safe SQL database interactions
- `typer`: CLI framework with rich help and completion


## Build System

### Package Management
```bash
# Install dependencies
uv sync --all-extras
# Add new dependency
uv add package-name
```

ALWAYS use uv for all python related tasks.

### Quality Assurance
- "duty lint" for all linting and formatting checks
- "duty test" for running tests
- "uv run pytest ..." for specific test files directories, patterns



# Project Structure & Organization

## Source Code Layout

The project follows a modular architecture with separate packages for each major component:

```
src/
├── llmling_agent/              # Core agent framework
│   ├── agent/                  # Agent implementation
│   ├── config/                 # Configuration management
│   ├── delegation/             # Multi-agent coordination (AgentPool, Teams)
│   ├── messaging/              # Message system and routing
│   ├── models/                 # Pydantic data models
│   ├── observability/          # Monitoring and logging
│   ├── prompts/                # Prompt management
│   ├── tasks/                  # Task execution
│   ├── tools/                  # Tool system
│   └── utils/                  # Shared utilities
├── llmling_agent_cli/          # Command-line interface
├── llmling_agent_commands/     # Slash command system
├── llmling_agent_config/       # Configuration schemas and loaders
├── llmling_agent_converters/   # Content conversion (audio, video, etc.)
├── llmling_agent_docs/         # Documentation generation + examples
├── llmling_agent_prompts/      # Prompt hub integrations
├── llmling_agent_resources/    # Resource management
├── llmling_agent_server/       # Web server and API
├── llmling_agent_storage/      # Storage providers (SQL, file, memory)
└── llmling_agent_toolsets/     # Tool collections (Composio, MCP, etc.)
```

## Key Architectural Patterns


### Configuration System
- **YAML-first**: All configuration via YAML files with JSON schema validation
- **Pydantic models**: Type-safe configuration with discriminated unions
- **Inheritance**: Agent configs can inherit from base configurations
- **Environment variants**: File-based vs inline environment definitions

### Messaging Architecture
- **MessageNode**: Base interface for all message-processing entities
- **Agents**: Individual LLM-powered actors
- **Teams**: Parallel execution groups (`agent1 & agent2`)
- **TeamRuns**: Sequential execution chains (`agent1 | agent2`)
- **Connections**: Configurable message routing between nodes


## File Naming Conventions

### Python Files
- **Snake case**: `agent_config.py`, `message_node.py`
- **Descriptive names**: Reflect the primary class or functionality
- **Module organization**: Group related functionality in packages

### Configuration Files
- **YAML extension**: `.yml` preferred over `.yaml`
- **Descriptive names**: `agents.yml`, `config.yml`, `manifest.yml`
- **Schema validation**: All YAML configs have corresponding Pydantic models

### Test Files
- **Test prefix**: `test_*.py` for pytest discovery, in folder `<project>/tests`
- **Mirror structure**: Test files mirror source structure
- **Async tests**: Use `pytest-asyncio` for async test functions

## Import Patterns
```python
# Absolute imports
from llmling_agent import Agent
from llmling_agent_config import AgentsManifest
```


### Type Annotations
- **Full typing**: All functions and methods have type annotations
- **Generic types**: Use `TypeVar` for generic agent types
- **Union types**: Use `|` syntax for Python 3.12+ union types
- **Optional imports**: Use `TYPE_CHECKING` for type-only imports


Rules:
- DO NOT USE getattr and hasattr in very rare exceptions. Always provide full type safety.
- never resort to shortcuts, never leave out stuff with TODOs unless explicitely asked.
